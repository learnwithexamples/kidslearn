<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Challenger Mental Math - KidsLearn</title>
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/fact-sheet.css">
    <style>
        /* ‚îÄ‚îÄ Equation Board ‚îÄ‚îÄ */
        .eq-board {
            background: linear-gradient(160deg, #0d0d1a 0%, #1a1a35 100%);
            border: 3px solid #3730a3;
            border-radius: 18px;
            padding: 40px 30px;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 6px;
            margin-bottom: 12px;
            position: relative;
            overflow: hidden;
        }
        .eq-board::after {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(ellipse at 50% 30%, rgba(99,102,241,0.13) 0%, transparent 68%);
            border-radius: 15px;
            pointer-events: none;
        }
        .eq-idle-msg {
            color: #4b5563;
            font-size: 1.25em;
            text-align: center;
            line-height: 1.8;
        }

        /* Step elements */
        .eq-step {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            opacity: 0;
            transform: translateY(14px);
            animation: stepIn 0.32s ease forwards;
            letter-spacing: 0.03em;
            transition: font-size 0.3s ease, color 0.3s ease;
        }
        @keyframes stepIn {
            to { opacity: 1; transform: translateY(0); }
        }
        .eq-step.first-num         { font-size: 3.8em; color: #fbbf24; }
        .eq-step.current           { font-size: 2.9em; color: #34d399; text-shadow: 0 0 24px rgba(52,211,153,0.6); }
        .eq-step.past              { font-size: 2.0em; color: #4b5563; }
        .eq-step.first-num.past    { font-size: 2.5em; color: #6b7280; }

        /* ‚îÄ‚îÄ Progress dots ‚îÄ‚îÄ */
        .progress-dots {
            display: flex;
            gap: 9px;
            justify-content: center;
            margin-bottom: 8px;
        }
        .dot {
            width: 11px; height: 11px;
            border-radius: 50%;
            background: #374151;
            transition: background 0.25s, box-shadow 0.25s;
        }
        .dot.active { background: #34d399; box-shadow: 0 0 8px rgba(52,211,153,0.8); }
        .dot.done   { background: #6366f1; }

        /* ‚îÄ‚îÄ Status bar ‚îÄ‚îÄ */
        .eq-status {
            text-align: center;
            color: #9ca3af;
            font-size: 1em;
            min-height: 28px;
            margin-bottom: 14px;
        }
        .speaking-pulse {
            display: inline-block;
            width: 10px; height: 10px;
            background: #34d399;
            border-radius: 50%;
            margin-right: 7px;
            vertical-align: middle;
            animation: blink 0.9s infinite;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; transform: scale(1); }
            50%       { opacity: 0.45; transform: scale(1.6); }
        }

        /* ‚îÄ‚îÄ Buttons ‚îÄ‚îÄ */
        .eq-controls { display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; margin-bottom: 22px; }

        .btn-start {
            padding: 14px 52px; font-size: 1.35em; font-weight: bold;
            background: linear-gradient(135deg, #6366f1, #4f46e5);
            color: white; border: none; border-radius: 14px; cursor: pointer;
            box-shadow: 0 4px 20px rgba(99,102,241,0.45);
            transition: all 0.2s; font-family: inherit;
        }
        .btn-start:hover { transform: translateY(-2px); box-shadow: 0 6px 28px rgba(99,102,241,0.65); }

        .btn-stop {
            padding: 14px 34px; font-size: 1.35em; font-weight: bold;
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white; border: none; border-radius: 14px; cursor: pointer;
            box-shadow: 0 4px 16px rgba(239,68,68,0.4);
            transition: all 0.2s; font-family: inherit;
        }
        .btn-stop:hover { transform: translateY(-2px); }

        .btn-redo {
            padding: 12px 28px; font-size: 1.05em; font-weight: bold;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white; border: none; border-radius: 12px; cursor: pointer;
            box-shadow: 0 3px 12px rgba(245,158,11,0.4);
            transition: all 0.2s; font-family: inherit;
        }
        .btn-redo:hover { transform: translateY(-2px); }

        .btn-new {
            padding: 12px 28px; font-size: 1.05em; font-weight: bold;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white; border: none; border-radius: 12px; cursor: pointer;
            box-shadow: 0 3px 12px rgba(16,185,129,0.4);
            transition: all 0.2s; font-family: inherit;
        }
        .btn-new:hover { transform: translateY(-2px); }

        /* ‚îÄ‚îÄ Answer section ‚îÄ‚îÄ */
        .answer-section {
            background: linear-gradient(135deg, #eef2ff, #e0e7ff);
            border: 3px solid #a5b4fc;
            border-radius: 15px;
            padding: 25px 30px;
            text-align: center;
            margin-bottom: 22px;
        }
        .answer-section h3 { color: #4338ca; margin-bottom: 16px; font-size: 1.45em; }
        .answer-row { display: flex; align-items: center; justify-content: center; gap: 12px; flex-wrap: wrap; }

        #answer-input {
            padding: 12px 18px; font-size: 1.75em; font-weight: bold;
            font-family: 'Courier New', monospace;
            border: 3px solid #a5b4fc; border-radius: 12px;
            text-align: center; width: 175px;
            transition: border-color 0.2s;
        }
        #answer-input:focus { outline: none; border-color: #6366f1; box-shadow: 0 0 0 3px rgba(99,102,241,0.2); }
        #answer-input::-webkit-inner-spin-button,
        #answer-input::-webkit-outer-spin-button { -webkit-appearance: none; }
        #answer-input[type=number] { -moz-appearance: textfield; }

        /* ‚îÄ‚îÄ Result ‚îÄ‚îÄ */
        .result-correct, .result-wrong {
            border-radius: 12px; padding: 14px 22px;
            font-size: 1.2em; font-weight: bold; margin-top: 16px;
        }
        .result-correct {
            background: #f0fff4; border: 3px solid #48bb78; color: #276749;
            animation: popIn 0.4s ease;
        }
        .result-wrong {
            background: #fff5f5; border: 3px solid #fc8181; color: #c53030;
            animation: shake 0.5s ease;
        }
        .result-wrong .hint { font-size: 0.85em; margin-top: 7px; color: #e53e3e; }

        @keyframes popIn {
            0%   { transform: scale(0.85); opacity: 0; }
            60%  { transform: scale(1.04); }
            100% { transform: scale(1);    opacity: 1; }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-8px); }
            40%, 80% { transform: translateX(8px); }
        }

        .result-btns { display: flex; gap: 12px; justify-content: center; margin-top: 16px; flex-wrap: wrap; }

        /* ‚îÄ‚îÄ Warning ‚îÄ‚îÄ */
        .no-speech-warn {
            background: #fffbeb; border: 2px solid #f59e0b;
            border-radius: 10px; padding: 12px 18px;
            color: #92400e; margin-bottom: 18px; font-size: 0.95em;
        }

        /* Voice selector */
        #voice-select {
            padding: 9px 12px;
            font-size: 1em;
            border: 2px solid #cbd5e0;
            border-radius: 8px;
            font-family: inherit;
            background: white;
            cursor: pointer;
            min-width: 220px;
            transition: border-color 0.2s;
        }
        #voice-select:focus { outline: none; border-color: #5a67d8; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üß† Challenger Mental Math</h1>
            <p class="subtitle">Listen ¬∑ Calculate in your head ¬∑ Answer!</p>
            <a href="math.html" class="back-link">‚Üê Back to Math Topics</a>
        </header>

        <div id="no-speech-warn" class="no-speech-warn" style="display:none">
            ‚ö†Ô∏è Speech synthesis is not available in your browser ‚Äî steps will be shown visually only.
        </div>

        <!-- Settings -->
        <div class="controls-panel">
            <div class="control-section">
                <h3>‚öôÔ∏è Settings</h3>
                <div class="number-settings">
                    <label>Min Number:
                        <input type="number" id="cfg-min" min="1" max="99" value="1">
                    </label>
                    <label>Max Number:
                        <input type="number" id="cfg-max" min="2" max="999" value="50">
                    </label>
                    <label>Numbers in equation:
                        <input type="number" id="cfg-count" min="2" max="10" value="5">
                    </label>
                    <label>Interval (seconds):
                        <input type="number" id="cfg-interval" min="0.5" max="10" step="0.5" value="1.5">
                    </label>
                    <label>Speech rate:
                        <input type="number" id="cfg-rate" min="0.5" max="1.5" step="0.05" value="0.85">
                    </label>
                    <label>Voice:
                        <select id="voice-select"><option value="">Loading voices‚Ä¶</option></select>
                    </label>
                </div>
            </div>
        </div>

        <!-- Equation board -->
        <div id="eq-board" class="eq-board">
            <div class="eq-idle-msg" id="idle-msg">
                üéØ Press <strong>Start</strong> to hear your equation!<br>
                <small style="color:#374151;font-size:0.78em">Make sure your sound is on üîä</small>
            </div>
        </div>

        <div class="progress-dots" id="progress-dots"></div>
        <div class="eq-status" id="eq-status"></div>

        <!-- Start / Stop -->
        <div class="eq-controls">
            <button id="btn-start" class="btn-start">‚ñ∂ Start</button>
            <button id="btn-stop"  class="btn-stop" style="display:none">‚èπ Stop</button>
        </div>

        <!-- Answer section (shown after equation completes) -->
        <div id="answer-section" class="answer-section" style="display:none">
            <h3>üí≠ What's your answer?</h3>
            <div class="answer-row">
                <input type="number" id="answer-input" placeholder="?" autocomplete="off">
                <button id="btn-check" class="primary-btn">‚úì Check</button>
            </div>
            <div id="result-display"></div>
            <div id="result-btns" class="result-btns" style="display:none">
                <button id="btn-redo" class="btn-redo">üîÑ Re-do Same</button>
                <button id="btn-new"  class="btn-new">‚ú® New Equation</button>
            </div>
        </div>

        <footer>
            <p>Train your brain ‚Äî one equation at a time! üß†</p>
        </footer>
    </div>

    <script src="../scripts/challenger-mental-math.js"></script>
</body>
</html>
